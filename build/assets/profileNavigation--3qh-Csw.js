import{c as I,b as N,e as c,x as M,s as E,u as S,z as F,D as z,q as a,f as s,g as t,i as l,w as y,h as j,v as A,C as $,d as U,E as V,a as h,j as x,n as b,G as q,_ as T,p as G,o as w}from"./index-CvdpWBVJ.js";import{S as L}from"./spinner-2xjK-I4S.js";import{u as R,r as g}from"./index-kTOYWjdU.js";var H=I("exclamation-mark","IconExclamationMark",[["path",{d:"M12 19v.01",key:"svg-0"}],["path",{d:"M12 15v-10",key:"svg-1"}]]);const J="/assets/male_doctor-Bbnjne80.png",K=N("verification",()=>{const i=c(null),n=c(null);return{result:i,resultValidation:n,async sendMessage(e){const r=await M.get(`/auth/send-message?phone_number=${e.phone_number}`);r.status===200?i.value=r.data:i.value=!1},async validatePhone(e){const r=await M.post("/auth/validate-phone",e);r.status===200?n.value=r.data:n.value=!1}}}),O={id:"verificationModal",class:"modal"},Q={class:"modal-box"},W=t("form",{method:"dialog"},[t("button",{class:"btn btn-sm btn-circle btn-ghost absolute right-2 top-2"}," ✕ ")],-1),X={key:0,class:"font-bold text-xl mb-5"},Y={key:1,class:"font-bold text-xl mb-5"},Z=t("button",{type:"submit",class:"btn btn-primary w-full mt-5"}," Отправить СМС ",-1),ee=[Z],te={class:"flex flex-col gap-3"},ae={class:"flex flex-col gap-1"},se=t("label",{for:"email",class:"text-[#9A9BA4]"}," Код верификации ",-1),oe={key:0,class:"text-sm text-gray-400 mt-2"},le={key:2,type:"submit",class:"btn btn-primary w-full mt-5"},ne={key:3,class:"btn btn-primary w-full mt-5"},ie=t("span",{class:"spinner"},null,-1),re=[ie],ue=t("form",{method:"dialog",class:"modal-backdrop"},[t("button",null,"close")],-1),de={__name:"verifyNumber",props:{numPhone:{type:String,required:!0}},setup(i){const n=K(),{result:e,resultValidation:r}=E(n),f=S(),u=c(!1),o=c(30),m=i,_=c({phone_number:""}),d=c({code:""}),p=async()=>{u.value=!0,await n.sendMessage(_.value),e!==!1&&(o.value=30,D()),u.value=!1},v=async()=>{u.value=!0,await n.validatePhone(d.value),await f.getProfile(),u.value=!1,verificationModal.close()};let k;const D=()=>{o.value=30,k=setInterval(()=>{o.value--,o.value===0&&clearInterval(k)},1e3)};return F(()=>{_.value.phone_number=m.numPhone}),z(()=>m.numPhone,C=>{_.value.phone_number=C}),(C,P)=>(a(),s("dialog",O,[t("div",Q,[W,l(e)===null||l(e)===!1?(a(),s("h3",X," Отправить письмо ")):(a(),s("h3",Y," Верификация номера ")),l(e)===null||l(e)===!1?(a(),s("form",{key:2,onSubmit:y(p,["prevent"]),action:""},ee,32)):(a(),s("form",{key:3,onSubmit:y(v,["prevent"]),action:""},[t("div",te,[t("div",ae,[se,j(t("input",{"onUpdate:modelValue":P[0]||(P[0]=B=>d.value.code=B),placeholder:"Введите код",type:"text",id:"email",class:"w-full py-3 px-3 border rounded-xl"},null,512),[[A,d.value.code]])])]),o.value>0?(a(),s("p",oe," Отправить код повторно можно будет через "+$(o.value)+" секунд ",1)):(a(),s("p",{key:1,class:"text-sm text-mainColor mt-2 cursor-pointer",onClick:p}," Отправить код повторно ")),u.value===!1?(a(),s("button",le," Верифицировать ")):(a(),s("div",ne,re))],32))]),ue]))}},ce={class:"block lg:flex justify-between gap-6"},me={class:"w-full lg:w-4/5"},pe={key:0},he={key:0,style:{"box-shadow":"0px 4px 20px 0px #0000001A"},class:"text-sm flex items-center gap-3 bg-white p-3 rounded-lg mb-5 w-full"},fe={class:"bg-red-500 rounded-full p-1 text-white w-14 h-14 flex items-center justify-center"},_e=t("div",null,[t("p",{class:"mb-2"},"Необходимо верифицировать номер"),t("button",{onclick:"verificationModal.showModal()",class:"bg-mainColor text-white rounded-lg px-10 py-2"}," Отправить код ")],-1),ve={style:{"box-shadow":"0px 4px 20px 0px #0000001A"},class:"flex mb-4 items-center bg-white w-full gap-3 lg:w-1/3 h-full p-5 rounded-lg"},xe={key:0,class:"relative h-full"},ge=["src"],be={key:1,class:"relative h-full"},we=t("img",{class:"min-w-28 w-28 min-h-28 h-28 rounded-full object-cover mx-auto",src:J,alt:""},null,-1),ye=[we],$e={key:0,class:"text-sm font-bold mb-3"},ke={class:"text-xs font-semibold text-mainColor px-5 py-1 rounded bg-[#E7F0FF] w-max"},Ce={key:2,class:"w-1/2 mx-auto mt-3"},Pe={key:0,class:"text-red-500 text-xs"},Me={key:1,class:"bg-white px-5 py-6 rounded-lg"},ze=U({__name:"profile",setup(i){const n=S(),{result:e}=E(n),r=c(!1),f=c(!0),u=c(!1),o=c({name:"",iin:"",height:"",weight:""}),m=R({name:{required:g},iin:{required:g},height:{required:g},weight:{required:g}},o);V(()=>e.value&&e.value.data&&e.value.data.name?e.value.data.name.split(" ").map(d=>d.charAt(0).toUpperCase()).join(""):""),V(()=>{if(e.value&&e.value.data&&e.value.data.user_data){const{height:d,weight:p}=e.value.data.user_data;return(p/(d/100*(d/100))).toFixed(2)}return""});const _=async()=>{if(r.value=!0,m.value.$validate(),m.value.$error){r.value=!1;return}await n.updateProfile(o.value),await n.getProfile(),r.value=!1,u.value=!1};return F(async()=>{await n.getProfile(),e.value===!1?(router.push("/"),f.value=!1):(o.value.name=e.value.data.name,o.value.iin=e.value.data.iin,e.value.data.user_data&&(o.value.height=e.value.data.user_data.height,o.value.weight=e.value.data.user_data.weight),f.value=!1)}),(d,p)=>(a(),s("div",ce,[t("div",me,[f.value?(a(),s("div",Me,[h(L)])):(a(),s("div",pe,[l(e).data.phone_number&&!l(e).data.is_phone_verified?(a(),s("div",he,[t("div",fe,[h(l(H),{size:"40"})]),_e])):x("",!0),t("form",{onSubmit:y(_,["prevent"]),class:"block lg:flex justify-between w-full gap-5 mb-6"},[t("div",ve,[l(e).data.img?(a(),s("div",xe,[t("img",{src:l(e).data.img,class:"min-w-28 w-28 min-h-28 h-28 rounded-full object-cover mx-auto",alt:""},null,8,ge)])):(a(),s("div",be,ye)),t("div",null,[u.value?x("",!0):(a(),s("h1",$e,$(l(e).data.name),1)),t("p",ke,$(l(e).data.staff.specialization.name),1)]),u.value?(a(),s("div",Ce,[j(t("input",{"onUpdate:modelValue":p[0]||(p[0]=v=>o.value.name=v),class:b([{"border-red-500":l(m).name.$error},"px-2 py-2 border rounded-lg w-full text-center"]),type:"text",placeholder:"Введите имя"},null,2),[[A,o.value.name]]),l(m).name.$error&&u.value?(a(),s("p",Pe," Пожалуйста заполните данное поле ")):x("",!0)])):x("",!0)])],32),t("div",null,[q(d.$slots,"default")]),h(de,{numPhone:l(e).data.phone_number},null,8,["numPhone"])]))])]))}}),Ve={},Ee={class:"w-full lg:w-1/5 mb-4 lg:mb-0"},Se={style:{"box-shadow":"0px 4px 20px 0px #0000001A"},class:"bg-white p-2 rounded-lg flex overflow-x-auto gap-1 text-sm"},Fe=t("p",null,"Мои данные",-1),je=t("p",null,"Мой профиль",-1),Ae=t("p",null,"Документы",-1);function De(i,n){const e=G("router-link");return a(),s("div",Ee,[t("div",Se,[h(e,{class:b(["flex items-center hover:bg-[#ECEDFF] hover:text-mainColor gap-3 px-3 py-2 rounded-lg transition-all whitespace-nowrap",{"bg-mainColor !text-white":i.$route.fullPath==="/profile/my-data"}]),to:"/profile/my-data"},{default:w(()=>[Fe]),_:1},8,["class"]),h(e,{class:b(["flex items-center hover:bg-[#ECEDFF] hover:text-mainColor gap-3 px-3 py-2 rounded-lg transition-all whitespace-nowrap",{"bg-mainColor !text-white":i.$route.fullPath==="/profile"}]),to:"/profile"},{default:w(()=>[je]),_:1},8,["class"]),h(e,{class:b(["flex items-center hover:bg-[#ECEDFF] hover:text-mainColor gap-3 px-3 py-2 rounded-lg transition-all whitespace-nowrap",{"bg-mainColor !text-white":i.$route.fullPath==="/profile/docs"}]),to:"/profile/docs"},{default:w(()=>[Ae]),_:1},8,["class"])])])}const Ue=T(Ve,[["render",De]]);export{Ue as P,ze as _};
