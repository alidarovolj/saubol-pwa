import{r as A,u as q,s as I,t as Z,x as $,y as B,a as c,b as p,i as V,j as H,F as O,o as m,e as v,A as x,d as z,B as G,z as L,v as P,n as S,f as N}from"./index-BZlZztwk.js";import{u as K,r as M}from"./index-Bwm06OAg.js";import{_ as Q,P as X}from"./profileNavigation-B8d4VpWp.js";import{I as Y,_ as ee}from"./setImage-auskhirE.js";import{u as te}from"./staff-D1zJf4JU.js";import{i as se}from"./index-BTutWPBR.js";import"./spinner-2k92dcTC.js";/*! maska v2.1.11 | (c) Alexander Shabunevich | Released under the MIT license */var ae=Object.defineProperty,ie=(a,t,e)=>t in a?ae(a,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[t]=e,R=(a,t,e)=>(ie(a,typeof t!="symbol"?t+"":t,e),e);const W={"#":{pattern:/[0-9]/},"@":{pattern:/[a-zA-Z]/},"*":{pattern:/[a-zA-Z0-9]/}};class F{constructor(t={}){R(this,"opts",{}),R(this,"memo",new Map);const e={...t};if(e.tokens!=null){e.tokens=e.tokensReplace?{...e.tokens}:{...W,...e.tokens};for(const s of Object.values(e.tokens))typeof s.pattern=="string"&&(s.pattern=new RegExp(s.pattern))}else e.tokens=W;Array.isArray(e.mask)&&(e.mask.length>1?e.mask=[...e.mask].sort((s,i)=>s.length-i.length):e.mask=e.mask[0]??""),e.mask===""&&(e.mask=null),this.opts=e}masked(t){return this.process(t,this.findMask(t))}unmasked(t){return this.process(t,this.findMask(t),!1)}isEager(){return this.opts.eager===!0}isReversed(){return this.opts.reversed===!0}completed(t){const e=this.findMask(t);if(this.opts.mask==null||e==null)return!1;const s=this.process(t,e).length;return typeof this.opts.mask=="string"?s>=this.opts.mask.length:typeof this.opts.mask=="function"?s>=e.length:this.opts.mask.filter(i=>s>=i.length).length===this.opts.mask.length}findMask(t){const e=this.opts.mask;if(e==null)return null;if(typeof e=="string")return e;if(typeof e=="function")return e(t);const s=this.process(t,e.slice(-1).pop()??"",!1);return e.find(i=>this.process(t,i,!1).length>=s.length)??""}escapeMask(t){const e=[],s=[];return t.split("").forEach((i,n)=>{i==="!"&&t[n-1]!=="!"?s.push(n-s.length):e.push(i)}),{mask:e.join(""),escaped:s}}process(t,e,s=!0){if(e==null)return t;const i=`value=${t},mask=${e},masked=${s?1:0}`;if(this.memo.has(i))return this.memo.get(i);const{mask:n,escaped:r}=this.escapeMask(e),u=[],o=this.opts.tokens!=null?this.opts.tokens:{},l=this.isReversed()?-1:1,y=this.isReversed()?"unshift":"push",k=this.isReversed()?0:n.length-1,f=this.isReversed()?()=>d>-1&&g>-1:()=>d<n.length&&g<t.length,h=b=>!this.isReversed()&&b<=k||this.isReversed()&&b>=k;let E,w=-1,d=this.isReversed()?n.length-1:0,g=this.isReversed()?t.length-1:0,T=!1;for(;f();){const b=n.charAt(d),_=o[b],C=(_==null?void 0:_.transform)!=null?_.transform(t.charAt(g)):t.charAt(g);if(!r.includes(d)&&_!=null?(C.match(_.pattern)!=null?(u[y](C),_.repeated?(w===-1?w=d:d===k&&d!==w&&(d=w-l),k===w&&(d-=l)):_.multiple&&(T=!0,d-=l),d+=l):_.multiple?T&&(d+=l,g-=l,T=!1):C===E?E=void 0:_.optional&&(d+=l,g-=l),g+=l):(s&&!this.isEager()&&u[y](b),C===b&&!this.isEager()?g+=l:E=b,this.isEager()||(d+=l)),this.isEager())for(;h(d)&&(o[n.charAt(d)]==null||r.includes(d));)s?u[y](n.charAt(d)):n.charAt(d)===t.charAt(g)&&(g+=l),d+=l}return this.memo.set(i,u.join("")),this.memo.get(i)}}const D=a=>JSON.parse(a.replaceAll("'",'"')),J=(a,t={})=>{const e={...t};return a.dataset.maska!=null&&a.dataset.maska!==""&&(e.mask=ne(a.dataset.maska)),a.dataset.maskaEager!=null&&(e.eager=U(a.dataset.maskaEager)),a.dataset.maskaReversed!=null&&(e.reversed=U(a.dataset.maskaReversed)),a.dataset.maskaTokensReplace!=null&&(e.tokensReplace=U(a.dataset.maskaTokensReplace)),a.dataset.maskaTokens!=null&&(e.tokens=oe(a.dataset.maskaTokens)),e},U=a=>a!==""?!!JSON.parse(a):!0,ne=a=>a.startsWith("[")&&a.endsWith("]")?D(a):a,oe=a=>{if(a.startsWith("{")&&a.endsWith("}"))return D(a);const t={};return a.split("|").forEach(e=>{const s=e.split(":");t[s[0]]={pattern:new RegExp(s[1]),optional:s[2]==="optional",multiple:s[2]==="multiple",repeated:s[2]==="repeated"}}),t};class le{constructor(t,e={}){R(this,"items",new Map),R(this,"beforeinputEvent",s=>{const i=s.target,n=this.items.get(i);n.isEager()&&"inputType"in s&&s.inputType.startsWith("delete")&&n.unmasked(i.value).length<=1&&this.setMaskedValue(i,"")}),R(this,"inputEvent",s=>{if(s instanceof CustomEvent&&s.type==="input"&&s.detail!=null&&typeof s.detail=="object"&&"masked"in s.detail)return;const i=s.target,n=this.items.get(i),r=i.value,u=i.selectionStart,o=i.selectionEnd;let l=r;if(n.isEager()){const y=n.masked(r),k=n.unmasked(r);k===""&&"data"in s&&s.data!=null?l=s.data:k!==n.unmasked(y)&&(l=k)}if(this.setMaskedValue(i,l),"inputType"in s&&(s.inputType.startsWith("delete")||u!=null&&u<r.length))try{i.setSelectionRange(u,o)}catch{}}),this.options=e,typeof t=="string"?this.init(Array.from(document.querySelectorAll(t)),this.getMaskOpts(e)):this.init("length"in t?Array.from(t):[t],this.getMaskOpts(e))}destroy(){for(const t of this.items.keys())t.removeEventListener("input",this.inputEvent),t.removeEventListener("beforeinput",this.beforeinputEvent);this.items.clear()}needUpdateOptions(t,e){const s=this.items.get(t),i=new F(J(t,this.getMaskOpts(e)));return JSON.stringify(s.opts)!==JSON.stringify(i.opts)}needUpdateValue(t){const e=t.dataset.maskaValue;return e==null&&t.value!==""||e!=null&&e!==t.value}getMaskOpts(t){const{onMaska:e,preProcess:s,postProcess:i,...n}=t;return n}init(t,e){for(const s of t){const i=new F(J(s,e));this.items.set(s,i),s.value!==""&&this.setMaskedValue(s,s.value),s.addEventListener("input",this.inputEvent),s.addEventListener("beforeinput",this.beforeinputEvent)}}setMaskedValue(t,e){const s=this.items.get(t);this.options.preProcess!=null&&(e=this.options.preProcess(e));const i=s.masked(e),n=s.unmasked(s.isEager()?i:e),r=s.completed(e),u={masked:i,unmasked:n,completed:r};e=i,this.options.postProcess!=null&&(e=this.options.postProcess(e)),t.value=e,t.dataset.maskaValue=e,this.options.onMaska!=null&&(Array.isArray(this.options.onMaska)?this.options.onMaska.forEach(o=>o(u)):this.options.onMaska(u)),t.dispatchEvent(new CustomEvent("maska",{detail:u})),t.dispatchEvent(new CustomEvent("input",{detail:u}))}}const j=new WeakMap,re=a=>{setTimeout(()=>{var t;((t=j.get(a))==null?void 0:t.needUpdateValue(a))===!0&&a.dispatchEvent(new CustomEvent("input"))})},ue=(a,t)=>{const e=a instanceof HTMLInputElement?a:a.querySelector("input"),s={...t.arg};if(e==null||(e==null?void 0:e.type)==="file")return;re(e);const i=j.get(e);if(i!=null){if(!i.needUpdateOptions(e,s))return;i.destroy()}if(t.value!=null){const n=t.value,r=u=>{n.masked=u.masked,n.unmasked=u.unmasked,n.completed=u.completed};s.onMaska=s.onMaska==null?r:Array.isArray(s.onMaska)?[...s.onMaska,r]:[s.onMaska,r]}j.set(e,new le(e,s))},de={class:"mt-8"},pe={class:"container mx-auto px-4 lg:px-0"},ce={key:0,style:{"box-shadow":"0px 4px 20px 0px #0000001A"},class:"mt-5 rounded-lg lg:mt-0 w-full bg-white"},me={class:"flex items-center justify-between text-mainColor w-full bg-[#E7F0FF] px-4 py-2"},he=p("h1",{class:"text-mainColor font-bold"}," Мои данные ",-1),fe={class:"flex items-center gap-5"},ve={class:"p-5 flex flex-col gap-3"},ke={class:""},ge=p("p",{class:"text-sm text-[#9A9BA4]"}," Профиль работы ",-1),_e={key:0,class:"p-3 border-b border-[#235CEE40]"},ye=p("option",{value:null}," Выберите специализацию ",-1),be=["value"],Ee={class:""},xe=p("p",{class:"text-sm text-[#9A9BA4]"}," Номер телефона ",-1),we={key:0,class:"p-3 border-b border-[#235CEE40]"},Ae={class:""},Me=p("p",{class:"text-sm text-[#9A9BA4]"}," ИИН ",-1),Re={key:0,class:"p-3 border-b border-[#235CEE40]"},Ce={class:""},Ve=p("p",{class:"text-sm text-[#9A9BA4]"}," Email ",-1),ze={key:0,class:"p-3 border-b border-[#235CEE40]"},Se={class:""},Te=p("p",{class:"text-sm text-[#9A9BA4]"}," Места работы ",-1),$e={class:"flex flex-col gap-1 border-b border-[#235CEE40]"},Oe={class:"p-3"},Pe={key:1},Ue={key:1,class:"bg-[#1EDA00] cursor-pointer text-white mt-4 text-center py-2 rounded-lg"},je=p("span",{class:"spinner"},null,-1),Be=[je],Ie={__name:"index",setup(a){const t=A("profile"),e=A(!1),s=A(!1),i=q(),{result:n}=I(i),r=te(),u=(k,f)=>{se(k,{type:f,autoClose:1e3})};A([{title:"Главная",link:"/"},{title:"Профиль",link:"/profile"}]);const o=A({name:"",iin:"",email:"",phone_number:"",specialization_id:null}),l=K({name:{required:M},iin:{required:M},email:{required:M},phone_number:{required:M},specialization_id:{required:M}},o),y=async()=>{if(s.value=!0,l.value.$touch(),l.value.$error){s.value=!1,console.log(l.value.$errors);return}await r.updateStaff(o.value),console.log(r.resultUpdate),r.resultUpdate!==!1?(await $(),u("Данные успешно обновлены","success"),await i.getProfile(),e.value=!1):u("Произошла ошибка","error"),s.value=!1};return Z(async()=>{await $(),await i.getProfile(),await r.specializationList(),o.value.name=n.value.data.name,o.value.iin=n.value.data.iin,o.value.phone_number=n.value.data.phone_number,o.value.email=n.value.data.email,o.value.specialization_id=n.value.data.staff.specialization.id}),B(i,()=>{o.value.name=n.value.data.name,o.value.iin=n.value.data.iin,o.value.phone_number=n.value.data.phone_number,o.value.email=n.value.data.email,o.value.specialization_id=n.value.data.staff.specialization.id}),B(r.resultUpdate,async()=>{await $(),await i.getProfile()}),(k,f)=>(m(),c(O,null,[p("div",de,[p("div",pe,[V(Q,{name:t.value},{default:H(()=>[V(X),v(n)?(m(),c("div",ce,[p("div",me,[he,p("div",fe,[V(v(Y),{class:"cursor-pointer",size:"24",onClick:f[0]||(f[0]=h=>e.value=!e.value)})])]),p("div",ve,[p("div",ke,[ge,e.value?z((m(),c("select",{key:1,"onUpdate:modelValue":f[1]||(f[1]=h=>o.value.specialization_id=h),type:"text",class:"p-3 border w-full rounded-lg"},[ye,(m(!0),c(O,null,L(v(r).resultSpecs,(h,E)=>(m(),c("option",{class:S({"border-red-500":v(l).specialization_id.$error}),key:E,value:h.id},x(h.name),11,be))),128))],512)),[[G,o.value.specialization_id]]):(m(),c("p",_e,x(v(n).data.staff.specialization.name),1))]),p("div",Ee,[xe,e.value?z((m(),c("input",{key:1,"onUpdate:modelValue":f[2]||(f[2]=h=>o.value.phone_number=h),"data-maska":"+7 (###) ###-##-##",class:S([{"border-red-500":v(l).phone_number.$error},"p-3 border w-full rounded-lg"]),type:"text",placeholder:"Введите телефон"},null,2)),[[P,o.value.phone_number],[v(ue)]]):(m(),c("p",we,x(v(n).data.phone_number),1))]),p("div",Ae,[Me,e.value?z((m(),c("input",{key:1,"onUpdate:modelValue":f[3]||(f[3]=h=>o.value.iin=h),class:S([{"border-red-500":v(l).iin.$error},"p-3 border w-full rounded-lg"]),type:"text",placeholder:"Введите телефон"},null,2)),[[P,o.value.iin]]):(m(),c("p",Re,x(v(n).data.iin),1))]),p("div",Ce,[Ve,e.value?z((m(),c("input",{key:1,"onUpdate:modelValue":f[4]||(f[4]=h=>o.value.email=h),class:S([{"border-red-500":v(l).email.$error},"p-3 border w-full rounded-lg"]),type:"text",placeholder:"Введите телефон"},null,2)),[[P,o.value.email]]):(m(),c("p",ze,x(v(n).data.email),1))]),p("div",Se,[Te,p("div",$e,[(m(!0),c(O,null,L(v(n).data.staff.job_places,(h,E)=>(m(),c("p",Oe,x(h.job_place),1))),256))])])])])):N("",!0),e.value?(m(),c("div",Pe,[s.value?(m(),c("p",Ue,Be)):(m(),c("p",{key:0,onClick:y,class:"bg-[#1EDA00] cursor-pointer text-white mt-4 text-center py-2 rounded-lg"}," Сохранить "))])):N("",!0)]),_:1},8,["name"])])]),V(ee)],64))}};export{Ie as default};
